<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Image Editor by Moodle AI Studio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <h1>🎨 AI Image Editor by Moodle AI Studio</h1>
        </div>

        <!-- 전역 액션 버튼 -->
        <div class="global-actions">
            <button class="btn btn-secondary" onclick="CommonModule.openSettingsModal()" title="설정">⚙️ 설정</button>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="CommonModule.switchTab(0)">📤 콘텐츠 업로드</button>
            <button class="tab-button" onclick="CommonModule.switchTab(1)">🏷️ 제품 이미지</button>
            <button class="tab-button" onclick="CommonModule.switchTab(2)">👤 제품+모델 이미지</button>
        </div>

        <!-- 탭 1: 콘텐츠 업로드 -->
        <div class="tab-content active" id="tab1">
            <div id="uploadContainer1" class="upload-area" onclick="document.getElementById('fileInput1').click()">
                <div class="upload-icon">🖼️/🎬</div>
                <div class="upload-text">파일을 드래그하거나 클릭하여 선택하세요</div>
                <input type="file" id="fileInput1" class="file-input" accept="image/*,video/*" onchange="Tab1Module.handleFileSelect(event)">
            </div>

            <div id="mainArea1" style="display:none;">
                <div class="preview-container" id="previewContainer1"></div>

                <div class="send-actions-container">
                    <h3>어떤 타입으로 전송하시겠어요?</h3>
                    <div class="send-buttons-grid">
                        <button class="btn btn-primary" data-type="portfolio_image" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>Image</button>
                        <button class="btn btn-primary" data-type="portfolio_video" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>Video</button>
                        <button class="btn btn-primary" data-type="product_ad_image" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>제품 광고 / Image</button>
                        <button class="btn btn-primary" data-type="product_ad_video" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>제품 광고 / Video</button>
                        <button class="btn btn-primary" data-type="client_ad_image" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>클라이언트 / Image</button>
                        <button class="btn btn-primary" data-type="client_ad_video" onclick="Tab1Module.confirmSend(this.dataset.type, this.textContent)" disabled>클라이언트 / Video</button>
                    </div>
                </div>
            </div>

            <div class="loading" id="loading1"><div class="spinner"></div> 전송 중입니다...</div>
        </div>

        <!-- 탭 2: 제품 이미지 -->
        <div class="tab-content" id="tab2">
            <div class="upload-area" id="uploadContainer2" onclick="document.getElementById('fileInput2').click()">
                <div class="upload-icon">📸</div>
                <div class="upload-text">제품 이미지를 선택하세요</div>
                <input type="file" id="fileInput2" class="file-input" accept="image/*" onchange="Tab2Module.handleFileSelect(event)">
            </div>

            <div id="mainArea2" style="display:none;">
                <div class="preview-container" id="previewContainer2"></div>

                <div class="mode-selection">
                    <div class="mode-option" onclick="Tab2Module.selectMode('auto')">
                        <div class="mode-icon">🤖</div>
                        <h4>자동 모드</h4>
                        <p>AI가 알아서 광고 이미지를 생성합니다</p>
                    </div>
                    <div class="mode-option" onclick="Tab2Module.selectMode('manual')">
                        <div class="mode-icon">✏️</div>
                        <h4>수동 모드</h4>
                        <p>프롬프트를 입력해서 원하는 스타일로 생성합니다</p>
                    </div>
                </div>

                <div class="manual-prompt" id="manualPrompt2">
                    <div class="form-group">
                        <label class="form-label" for="promptInput2">생성할 광고 이미지 스타일을 설명해주세요</label>
                        <textarea id="promptInput2" class="form-textarea" placeholder="예: 깔끔한 흰색 배경에 제품을 중앙에 배치하고, 고급스러운 느낌의 조명과 그림자 효과를 추가해주세요."></textarea>
                    </div>
                </div>

                <button class="btn btn-primary" id="generateBtn2" onclick="Tab2Module.generateImages()" disabled>🎨 광고 이미지 생성</button>

                <div class="result-images" id="resultImages2" style="display:none;"></div>
            </div>

            <div class="loading" id="loading2"><div class="spinner"></div> 이미지 생성 중입니다...</div>
        </div>

        <!-- 탭 3: 제품+모델 이미지 -->
        <div class="tab-content" id="tab3">
            <div class="dual-upload">
                <div class="upload-section">
                    <h4>📸 제품 이미지</h4>
                    <div class="upload-area" id="uploadContainer3a" onclick="document.getElementById('fileInput3a').click()">
                        <div class="upload-icon">🏷️</div>
                        <div class="upload-text">제품 이미지 선택</div>
                        <input type="file" id="fileInput3a" class="file-input" accept="image/*" onchange="Tab3Module.handleFileSelect(event, 'product')">
                    </div>
                    <div class="preview-container" id="previewContainer3a"></div>
                </div>

                <div class="upload-section">
                    <h4>👤 모델 이미지</h4>
                    <div class="upload-area" id="uploadContainer3b" onclick="document.getElementById('fileInput3b').click()">
                        <div class="upload-icon">🙋</div>
                        <div class="upload-text">모델 이미지 선택</div>
                        <input type="file" id="fileInput3b" class="file-input" accept="image/*" onchange="Tab3Module.handleFileSelect(event, 'model')">
                    </div>
                    <div class="preview-container" id="previewContainer3b"></div>
                </div>
            </div>

            <div id="mainArea3" style="display:none;">
                <div class="form-group">
                    <label class="form-label" for="promptInput3">광고 시나리오를 설명해주세요 (필수)</label>
                    <textarea id="promptInput3" class="form-textarea" placeholder="예: 모델이 제품을 자연스럽게 소개하는 모습으로, 밝고 친근한 분위기의 배경에서 제품의 장점을 강조하는 광고 이미지를 만들어주세요."></textarea>
                </div>

                <button class="btn btn-primary" id="generateBtn3" onclick="Tab3Module.generateImages()" disabled>🎨 광고 이미지 생성</button>

                <div class="result-images" id="resultImages3" style="display:none;"></div>
            </div>

            <div class="loading" id="loading3"><div class="spinner"></div> 이미지 생성 중입니다...</div>
        </div>

        <!-- 상태 메시지 -->
        <div class="status-section">
            <div class="status-title">📋 상태</div>
            <div class="status-content" id="statusContent">시작하려면 탭을 선택하고 파일을 업로드해주세요.</div>
        </div>
    </div>

    <!-- 설정 모달 -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">⚙️ 설정</div>
                <span class="close" onclick="CommonModule.closeSettingsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="imageWebhookUrl">Image 웹훅 URL</label>
                    <input type="url" id="imageWebhookUrl" class="form-input" placeholder="https://hook.us2.make.com/...">
                </div>
                <div class="form-group">
                    <label class="form-label" for="videoWebhookUrl">Video 웹훅 URL</label>
                    <input type="url" id="videoWebhookUrl" class="form-input" placeholder="https://hook.us2.make.com/...">
                </div>
                <div class="form-group">
                    <label class="form-label" for="nanoBananaApiKey">Nano Banana API 키</label>
                    <input type="password" id="nanoBananaApiKey" class="form-input" placeholder="sk-...">
                </div>
                <div class="form-group">
                    <label class="form-label">테마 선택</label>
                    <div class="theme-selector">
                        <button class="theme-button theme-classic active" onclick="CommonModule.changeTheme('default')">클래식</button>
                        <button class="theme-button theme-dark" onclick="CommonModule.changeTheme('dark')">다크</button>
                        <button class="theme-button theme-mint" onclick="CommonModule.changeTheme('mint')">민트</button>
                        <button class="theme-button theme-sunset" onclick="CommonModule.changeTheme('sunset')">선셋</button>
                        <button class="theme-button theme-ocean" onclick="CommonModule.changeTheme('ocean')">오션</button>
                        <button class="theme-button theme-forest" onclick="CommonModule.changeTheme('forest')">포레스트</button>
                        <button class="theme-button theme-rosegold" onclick="CommonModule.changeTheme('rosegold')">로즈골드</button>
                        <button class="theme-button theme-neon" onclick="CommonModule.changeTheme('neon')">네온</button>
                        <button class="theme-button theme-cream" onclick="CommonModule.changeTheme('cream')">크림</button>
                        <button class="theme-button theme-midnight" onclick="CommonModule.changeTheme('midnight')">미드나잇</button>
                        <button class="theme-button theme-lavender" onclick="CommonModule.changeTheme('lavender')">라벤더</button>
                        <button class="theme-button theme-coral" onclick="CommonModule.changeTheme('coral')">코랄</button>
                        <button class="theme-button theme-turkish" onclick="CommonModule.changeTheme('turkish')">터키시</button>
                        <button class="theme-button theme-golden" onclick="CommonModule.changeTheme('golden')">골든</button>
                        <button class="theme-button theme-aqua" onclick="CommonModule.changeTheme('aqua')">아쿠아</button>
                        <button class="theme-button theme-purple" onclick="CommonModule.changeTheme('purple')">퍼플</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="CommonModule.closeSettingsModal()">취소</button>
                <button class="btn btn-primary" onclick="CommonModule.saveSettings()">저장</button>
            </div>
        </div>
    </div>

    <!-- JavaScript 모듈들 로드 -->
    <script src="js/common.js"></script>
    <script src="js/tab1.js"></script>
    <script src="js/tab2.js"></script>
    <script src="js/tab3.js"></script>
</body>
</html>
